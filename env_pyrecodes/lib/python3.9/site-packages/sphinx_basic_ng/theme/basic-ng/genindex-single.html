{# Module: single page index, split by a "key" #}
{% extends "page.html" %}

{% block head_title -%}
  {{ _("Index") }} - {{ docstitle|striptags|e }}
{%- endblock head_title %}

{% macro indexentries(firstname, links) -%}
  {% if links -%}
    <a href="{{ links[0][1] }}">
      {%- if links[0][0] %}<strong>{% endif -%}
      {{ firstname|e }}
      {%- if links[0][0] %}</strong>{% endif -%}
    </a>

    {%- for ismain, link in links[1:] -%}
      , <a href="{{ link }}">
        {%- if ismain %}<strong>{% endif -%}
        [{{ loop.index }}]
        {%- if ismain %}</strong>{% endif -%}
      </a>
    {%- endfor %}
  {%- else %}
    {{ firstname|e }}
  {%- endif %}
{% endmacro %}

{% block content %}
<div class="sb-article-container">
  <article role="main">

{% block content_inner %}
<section class="genindex-section">
  <h1 id="index">{% trans key=key %}Index &ndash; {{ key }}{% endtrans %}</h1>
</section>

<section id="{{ key }}" class="genindex-section">
  <table style="width: 100%" class="indextable"><tr>
    {%- for column in entries|slice(2) if column %}
    <td style="width: 33%; vertical-align: top;"><ul>
      {%- for entryname, (links, subitems, _) in column %}
        <li>{{ indexentries(entryname, links) }}
        {%- if subitems %}
        <ul>
        {%- for subentryname, subentrylinks in subitems %}
          <li>{{ indexentries(subentryname, subentrylinks) }}</li>
        {%- endfor %}
        </ul>
        {%- endif -%}</li>
      {%- endfor %}
    </ul></td>
    {%- endfor %}
  </tr></table>
</section>
{% endblock content_inner %}

</article></div>
{% endblock %}
